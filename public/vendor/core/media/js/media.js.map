{"version":3,"file":"/js/media.js","sources":["webpack:////js/media.js"],"sourcesContent":["!function(e){function t(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var a={};t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,\"a\",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=7)}([function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return o});var i=a(1),r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:\"getUrlParam\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t||(t=window.location.search);var a=new RegExp(\"(?:[?&]|&)\"+e+\"=([^&]+)\",\"i\"),n=t.match(a);return n&&n.length>1?n[1]:null}},{key:\"asset\",value:function(e){if(\"//\"==e.substring(0,2)||\"http://\"==e.substring(0,7)||\"https://\"==e.substring(0,8))return e;var t=\"/\"!=RV_MEDIA_URL.base_url.substr(-1,1)?RV_MEDIA_URL.base_url+\"/\":RV_MEDIA_URL.base_url;return\"/\"==e.substring(0,1)?t+e.substring(1):t+e}},{key:\"showAjaxLoading\",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:$(\".rv-media-items\")).addClass(\"on-loading\").append($(\"#rv_media_loading\").html())}},{key:\"hideAjaxLoading\",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:$(\".rv-media-items\")).removeClass(\"on-loading\").find(\".loading-wrapper\").remove()}},{key:\"isOnAjaxLoading\",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:$(\".rv-media-items\")).hasClass(\"on-loading\")}},{key:\"jsonEncode\",value:function(e){return void 0===e&&(e=null),JSON.stringify(e)}},{key:\"jsonDecode\",value:function(e,t){if(!e)return t;if(\"string\"==typeof e){var a=void 0;try{a=$.parseJSON(e)}catch(e){a=t}return a}return e}},{key:\"getRequestParams\",value:function(){return\"modal\"==e.getUrlParam(\"open_in\")?$.extend(!0,i.a.request_params,window.rvMedia.options||{}):i.a.request_params}},{key:\"getConfigs\",value:function(){return i.a}},{key:\"storeConfig\",value:function(){localStorage.setItem(\"MediaConfig\",e.jsonEncode(i.a))}},{key:\"storeRecentItems\",value:function(){localStorage.setItem(\"RecentItems\",e.jsonEncode(i.b))}},{key:\"addToRecent\",value:function(e){e instanceof Array?_.each(e,function(e){i.b.push(e)}):i.b.push(e)}},{key:\"getItems\",value:function(){var e=[];return $(\".js-media-list-title\").each(function(){var t=$(this),a=t.data()||{};a.index_key=t.index(),e.push(a)}),e}},{key:\"getSelectedItems\",value:function(){var e=[];return $(\".js-media-list-title input[type=checkbox]:checked\").each(function(){var t=$(this).closest(\".js-media-list-title\"),a=t.data()||{};a.index_key=t.index(),e.push(a)}),e}},{key:\"getSelectedFiles\",value:function(){var e=[];return $(\".js-media-list-title[data-context=file] input[type=checkbox]:checked\").each(function(){var t=$(this).closest(\".js-media-list-title\"),a=t.data()||{};a.index_key=t.index(),e.push(a)}),e}},{key:\"getSelectedFolder\",value:function(){var e=[];return $(\".js-media-list-title[data-context=folder] input[type=checkbox]:checked\").each(function(){var t=$(this).closest(\".js-media-list-title\"),a=t.data()||{};a.index_key=t.index(),e.push(a)}),e}},{key:\"isUseInModal\",value:function(){return\"select-files\"==e.getUrlParam(\"media-action\")||window.rvMedia&&window.rvMedia.options&&\"modal\"==window.rvMedia.options.open_in}}]),e}()},function(e,t,a){\"use strict\";a.d(t,\"a\",function(){return n}),a.d(t,\"b\",function(){return r});var n=$.parseJSON(localStorage.getItem(\"MediaConfig\"))||{},i={app_key:\"483a0xyzytz1242c0d520426e8ba366c530c3d9dxxx\",request_params:{view_type:\"tiles\",filter:\"everything\",view_in:\"my_media\",search:\"\",sort_by:\"created_at-desc\",folder_id:0},hide_details_pane:!1,icons:{folder:\"fa fa-folder-o\"},actions_list:{basic:[{icon:\"fa fa-eye\",name:\"Preview\",action:\"preview\",order:0,class:\"rv-action-preview\"}],file:[{icon:\"fa fa-link\",name:\"Copy link\",action:\"copy_link\",order:0,class:\"rv-action-copy-link\"},{icon:\"fa fa-pencil\",name:\"Rename\",action:\"rename\",order:1,class:\"rv-action-rename\"},{icon:\"fa fa-copy\",name:\"Make a copy\",action:\"make_copy\",order:2,class:\"rv-action-make-copy\"},{icon:\"fa fa-dot-circle-o\",name:\"Set focus point\",action:\"set_focus_point\",order:3,class:\"rv-action-set-focus-point\"}],user:[{icon:\"fa fa-share-alt\",name:\"Share\",action:\"share\",order:0,class:\"rv-action-share\"},{icon:\"fa fa-ban\",name:\"Remove share\",action:\"remove_share\",order:1,class:\"rv-action-remove-share\"},{icon:\"fa fa-star\",name:\"Favorite\",action:\"favorite\",order:2,class:\"rv-action-favorite\"},{icon:\"fa fa-star-o\",name:\"Remove favorite\",action:\"remove_favorite\",order:3,class:\"rv-action-favorite\"}],other:[{icon:\"fa fa-download\",name:\"Download\",action:\"download\",order:0,class:\"rv-action-download\"},{icon:\"fa fa-trash\",name:\"Move to trash\",action:\"trash\",order:1,class:\"rv-action-trash\"},{icon:\"fa fa-eraser\",name:\"Delete permanently\",action:\"delete\",order:2,class:\"rv-action-delete\"},{icon:\"fa fa-undo\",name:\"Restore\",action:\"restore\",order:3,class:\"rv-action-restore\"}]},denied_download:[\"youtube\"]};n.app_key&&n.app_key===i.app_key||(n=i);var r=$.parseJSON(localStorage.getItem(\"RecentItems\"))||[]},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return r});var i=(a(0),function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}()),r=function(){function e(){n(this,e)}return i(e,null,[{key:\"showMessage\",value:function(e,t,a){toastr.options={closeButton:!0,progressBar:!0,positionClass:\"toast-bottom-right\",onclick:null,showDuration:1e3,hideDuration:1e3,timeOut:1e4,extendedTimeOut:1e3,showEasing:\"swing\",hideEasing:\"linear\",showMethod:\"fadeIn\",hideMethod:\"fadeOut\"},toastr[e](t,a)}},{key:\"handleError\",value:function(t){void 0!==t.responseJSON?void 0!==t.responseJSON.message?e.showMessage(\"error\",t.responseJSON.message,RV_MEDIA_CONFIG.translations.message.error_header):$.each(t.responseJSON,function(t,a){$.each(a,function(t,a){e.showMessage(\"error\",a,RV_MEDIA_CONFIG.translations.message.error_header)})}):e.showMessage(\"error\",t.statusText,RV_MEDIA_CONFIG.translations.message.error_header)}}]),e}()},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return f});var i=a(1),r=a(0),o=a(2),s=a(4),c=a(9),l=a(6),d=a(10),u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),f=function(){function e(){n(this,e),this.MediaList=new l.a,this.MediaDetails=new d.a,this.breadcrumbTemplate=$(\"#rv_media_breadcrumb_item\").html()}return u(e,[{key:\"getMedia\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this,n=r.a.getRequestParams();\"recent\"==n.view_in&&(n.recent_items=i.b),$.ajax({url:RV_MEDIA_URL.get_media,type:\"GET\",data:n,dataType:\"json\",beforeSend:function(){r.a.showAjaxLoading()},success:function(n){a.MediaList.renderData(n.data,t),a.fetchQuota(),a.renderBreadcrumbs(n.data.breadcrumbs),e.refreshFilter(),s.a.renderActions(),a.getFileDetails({icon:\"fa fa-picture-o\",nothing_selected:\"\"})},complete:function(e){r.a.hideAjaxLoading()},error:function(e){o.a.handleError(e)}})}},{key:\"getFileDetails\",value:function(e){this.MediaDetails.renderData(e)}},{key:\"fetchQuota\",value:function(){$.ajax({url:RV_MEDIA_URL.get_quota,type:\"GET\",dataType:\"json\",beforeSend:function(){},success:function(e){var t=e.data;$(\".rv-media-aside-bottom .used-analytics span\").html(t.used+\" / \"+t.quota),$(\".rv-media-aside-bottom .progress-bar\").css({width:t.percent+\"%\"})},error:function(e){o.a.handleError(e)}})}},{key:\"renderBreadcrumbs\",value:function(e){var t=this,a=$(\".rv-media-breadcrumb .breadcrumb\");a.find(\"li\").remove(),_.each(e,function(e,n){var i=t.breadcrumbTemplate;i=i.replace(/__name__/gi,e.name||\"\").replace(/__icon__/gi,e.icon?'<i class=\"'+e.icon+'\"></i>':\"\").replace(/__folderId__/gi,e.id||0),a.append($(i))}),$(\".rv-media-container\").attr(\"data-breadcrumb-count\",_.size(e))}}],[{key:\"refreshFilter\",value:function(){var e=$(\".rv-media-container\"),t=r.a.getRequestParams().view_in;\"my_media\"!=t&&(\"shared\"!=t&&\"shared_with_me\"!=t&&\"public\"!=t||0==r.a.getRequestParams().folder_id)?($('.rv-media-actions .btn:not([data-type=\"refresh\"]):not(label)').addClass(\"disabled\"),e.attr(\"data-allow-upload\",\"false\")):($('.rv-media-actions .btn:not([data-type=\"refresh\"]):not(label)').removeClass(\"disabled\"),e.attr(\"data-allow-upload\",\"true\")),$(\".rv-media-actions .btn.js-rv-media-change-filter-group\").removeClass(\"disabled\");var a=$('.rv-media-actions .btn[data-action=\"empty_trash\"]');\"trash\"==t?(a.removeClass(\"hidden\").removeClass(\"disabled\"),_.size(r.a.getItems())||a.addClass(\"hidden\").addClass(\"disabled\")):a.addClass(\"hidden\"),c.a.destroyContext(),c.a.initContext(),e.attr(\"data-view-in\",t)}}]),e}()},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return c});var i=a(1),r=a(0),o=a(2),s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),c=function(){function e(){n(this,e)}return s(e,null,[{key:\"handleDropdown\",value:function(){var t=_.size(r.a.getSelectedItems());e.renderActions(),t>0?$(\".rv-dropdown-actions\").removeClass(\"disabled\"):$(\".rv-dropdown-actions\").addClass(\"disabled\")}},{key:\"handlePreview\",value:function(){var e=[];_.each(r.a.getSelectedFiles(),function(t,a){_.contains([\"image\",\"youtube\",\"pdf\",\"text\"],t.type)&&(e.push({src:t.url}),i.b.push(t.id))}),_.size(e)>0?($.fancybox.open(e),r.a.storeRecentItems()):this.handleGlobalAction(\"download\")}},{key:\"handleCopyLink\",value:function(){var e=\"\";_.each(r.a.getSelectedFiles(),function(t,a){_.isEmpty(e)||(e+=\"\\n\"),e+=t.full_url});var t=$(\".js-rv-clipboard-temp\");t.data(\"clipboard-text\",e),new Clipboard(\".js-rv-clipboard-temp\",{text:function(t){return e}}),o.a.showMessage(\"success\",RV_MEDIA_CONFIG.translations.clipboard.success,RV_MEDIA_CONFIG.translations.message.success_header),t.trigger(\"click\")}},{key:\"handleGlobalAction\",value:function(t,a){var n=[];switch(_.each(r.a.getSelectedItems(),function(e,t){n.push({is_folder:e.is_folder,id:e.id,full_url:e.full_url,focus:e.focus})}),t){case\"rename\":$(\"#modal_rename_items\").modal(\"show\").find(\"form.rv-form\").data(\"action\",t);break;case\"copy_link\":e.handleCopyLink();break;case\"preview\":e.handlePreview();break;case\"set_focus_point\":var i=$(\"#modal_set_focus_point\");0===n[0].focus.length?(i.find(\".helper-tool-data-attr\").val(\"\"),i.find(\".helper-tool-css3-val\").val(\"\"),i.find(\".helper-tool-reticle-css\").val(\"\"),$(\".reticle\").removeAttr(\"style\")):(i.find(\".helper-tool-data-attr\").val(n[0].focus.data_attribute),i.find(\".helper-tool-css3-val\").val(n[0].focus.css_bg_position),i.find(\".helper-tool-reticle-css\").val(n[0].focus.retice_css),$(\".reticle\").prop(\"style\",n[0].focus.retice_css)),i.modal(\"show\").find(\"form.rv-form\").data(\"action\",t).data(\"image\",n[0].full_url);break;case\"trash\":$(\"#modal_trash_items\").modal(\"show\").find(\"form.rv-form\").data(\"action\",t);break;case\"delete\":$(\"#modal_delete_items\").modal(\"show\").find(\"form.rv-form\").data(\"action\",t);break;case\"share\":$(\"#modal_share_items\").modal(\"show\").find(\"form.rv-form\").data(\"action\",t);break;case\"empty_trash\":$(\"#modal_empty_trash\").modal(\"show\").find(\"form.rv-form\").data(\"action\",t);break;case\"download\":var s=RV_MEDIA_URL.download,c=0;_.each(r.a.getSelectedItems(),function(e,t){_.contains(r.a.getConfigs().denied_download,e.mime_type)||(s+=(0===c?\"?\":\"&\")+\"selected[\"+c+\"][is_folder]=\"+e.is_folder+\"&selected[\"+c+\"][id]=\"+e.id,c++)}),s!==RV_MEDIA_URL.download?window.open(s,\"_blank\"):o.a.showMessage(\"error\",RV_MEDIA_CONFIG.translations.download.error,RV_MEDIA_CONFIG.translations.message.error_header);break;default:e.processAction({selected:n,action:t},a)}}},{key:\"processAction\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;$.ajax({url:RV_MEDIA_URL.global_actions,type:\"POST\",data:e,dataType:\"json\",beforeSend:function(){r.a.showAjaxLoading()},success:function(e){e.error?o.a.showMessage(\"error\",e.message,RV_MEDIA_CONFIG.translations.message.error_header):o.a.showMessage(\"success\",e.message,RV_MEDIA_CONFIG.translations.message.success_header),t&&t(e)},complete:function(e){r.a.hideAjaxLoading()},error:function(e){o.a.handleError(e)}})}},{key:\"renderRenameItems\",value:function(){var e=$(\"#rv_media_rename_item\").html(),t=$(\"#modal_rename_items .rename-items\").empty();_.each(r.a.getSelectedItems(),function(a,n){var i=e.replace(/__icon__/gi,a.icon||\"fa fa-file-o\").replace(/__placeholder__/gi,\"Input file name\").replace(/__value__/gi,a.name),r=$(i);r.data(\"id\",a.id),r.data(\"is_folder\",a.is_folder),r.data(\"name\",a.name),t.append(r)})}},{key:\"renderActions\",value:function(){var e=r.a.getSelectedFolder().length>0,t=$(\"#rv_action_item\").html(),a=0,n=$(\".rv-dropdown-actions .dropdown-menu\");n.empty();var i=$.extend({},!0,r.a.getConfigs().actions_list);e&&(i.basic=_.reject(i.basic,function(e){return\"preview\"===e.action}),i.file=_.reject(i.file,function(e){return\"copy_link\"===e.action}),i.file=_.reject(i.file,function(e){return\"set_focus_point\"===e.action}),_.contains(RV_MEDIA_CONFIG.permissions,\"folders.create\")||(i.file=_.reject(i.file,function(e){return\"make_copy\"===e.action})),_.contains(RV_MEDIA_CONFIG.permissions,\"folders.edit\")||(i.file=_.reject(i.file,function(e){return _.contains([\"rename\"],e.action)}),i.user=_.reject(i.user,function(e){return _.contains([\"rename\",\"share\",\"remove_share\",\"un_share\"],e.action)})),_.contains(RV_MEDIA_CONFIG.permissions,\"folders.delete\")||(i.other=_.reject(i.other,function(e){return _.contains([\"trash\",\"delete\",\"restore\"],e.action)})));var o=r.a.getSelectedFiles();o.length>0&&\"image\"!==o[0].type&&(i.file=_.reject(i.file,function(e){return\"set_focus_point\"===e.action}));var s=!1;_.each(o,function(e){_.contains([\"image\",\"youtube\",\"pdf\",\"text\"],e.type)&&(s=!0)}),s||(i.basic=_.reject(i.basic,function(e){return\"preview\"===e.action})),\"simple\"===RV_MEDIA_CONFIG.mode&&(i.user=_.reject(i.user,function(e){return _.contains([\"share\",\"remove_share\",\"un_share\"],e.action)})),o.length>0&&(_.contains(RV_MEDIA_CONFIG.permissions,\"files.create\")||(i.file=_.reject(i.file,function(e){return\"make_copy\"===e.action})),_.contains(RV_MEDIA_CONFIG.permissions,\"files.edit\")||(i.file=_.reject(i.file,function(e){return _.contains([\"rename\",\"set_focus_point\"],e.action)}),i.user=_.reject(i.user,function(e){return _.contains([\"share\",\"remove_share\",\"un_share\"],e.action)})),_.contains(RV_MEDIA_CONFIG.permissions,\"files.delete\")||(i.other=_.reject(i.other,function(e){return _.contains([\"trash\",\"delete\",\"restore\"],e.action)}))),_.each(i,function(e,i){_.each(e,function(e,o){var s=!1;switch(r.a.getRequestParams().view_in){case\"my_media\":_.contains([\"remove_favorite\",\"delete\",\"restore\",\"remove_share\"],e.action)&&(s=!0);break;case\"shared\":_.contains([\"remove_favorite\",\"delete\",\"restore\",\"make_copy\",\"remove_share\"],e.action)&&(s=!0);break;case\"shared_with_me\":_.contains([\"remove_favorite\",\"delete\",\"restore\",\"make_copy\",\"share\"],e.action)&&(s=!0);break;case\"public\":_.contains([\"remove_favorite\",\"delete\",\"restore\",\"make_copy\",\"share\",\"remove_share\"],e.action)&&(s=!0);break;case\"recent\":_.contains([\"remove_favorite\",\"delete\",\"restore\",\"make_copy\",\"remove_share\"],e.action)&&(s=!0);break;case\"favorites\":_.contains([\"favorite\",\"delete\",\"restore\",\"make_copy\",\"remove_share\"],e.action)&&(s=!0);break;case\"trash\":_.contains([\"preview\",\"delete\",\"restore\",\"rename\",\"download\"],e.action)||(s=!0)}if(!s){var c=t.replace(/__action__/gi,e.action||\"\").replace(/__icon__/gi,e.icon||\"\").replace(/__name__/gi,RV_MEDIA_CONFIG.translations.actions_list[i][e.action]||e.name);!o&&a&&(c='<li role=\"separator\" class=\"divider\"></li>'+c),n.append(c)}}),e.length>0&&a++})}}]),e}()},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(t,\"__esModule\",{value:!0}),a.d(t,\"EditorService\",function(){return o});var i=a(0),r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:\"editorSelectFile\",value:function(e){var t=i.a.getUrlParam(\"CKEditor\")||i.a.getUrlParam(\"CKEditorFuncNum\");if(window.opener&&t){var a=_.first(e);window.opener.CKEDITOR.tools.callFunction(i.a.getUrlParam(\"CKEditorFuncNum\"),a.url),window.opener&&window.close()}}}]),e}(),s=function e(t,a){n(this,e),window.rvMedia=window.rvMedia||{};var r=$(\"body\"),o={multiple:!0,type:\"*\",onSelectFiles:function(e,t){}};a=$.extend(!0,o,a);var s=function(e){e.preventDefault();var t=$(this);$(\"#rv_media_modal\").modal(),window.rvMedia.options=a,window.rvMedia.options.open_in=\"modal\",window.rvMedia.$el=t,0==$(\"#rv_media_body .rv-media-container\").length?$(\"#rv_media_body\").load(RV_MEDIA_URL.popup,function(e){e.error&&alert(e.message),$(document).find(\".rv-media-container .js-change-action[data-type=refresh]\").trigger(\"click\"),$(\"#rv_media_body\").removeClass(\"media-modal-loading\").closest(\".modal-content\").removeClass(\"bb-loading\")}):$(document).find(\".rv-media-container .js-change-action[data-type=refresh]\").trigger(\"click\")};\"string\"==typeof t?r.on(\"click\",t,s):t.on(\"click\",s),$(\"#rv_media_modal\").off(\"click\",\".js-insert-to-editor\").on(\"click\",\".js-insert-to-editor\",function(e){e.preventDefault();var t=i.a.getSelectedFiles();_.size(t)>0&&(window.rvMedia.options.onSelectFiles(t,window.rvMedia.$el),$(\"#rv_media_modal\").modal(\"hide\"))}),$(\"#rv_media_modal\").off(\"dblclick\",\".js-media-list-title\").on(\"dblclick\",\".js-media-list-title\",function(e){e.preventDefault();var t=i.a.getSelectedFiles();_.size(t)>0&&(window.rvMedia.options.onSelectFiles(t,window.rvMedia.$el),$(\"#rv_media_modal\").modal(\"hide\"))})};window.RvMediaStandAlone=s,$(\".js-insert-to-editor\").off(\"click\").on(\"click\",function(e){e.preventDefault();var t=i.a.getSelectedFiles();_.size(t)>0&&o.editorSelectFile(t)}),$.fn.rvMedia=function(e){var t=$(this);new s(t,e)}},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return s});var i=a(0),r=a(4),o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=function(){function e(){n(this,e),this.group={},this.group.list=$(\"#rv_media_items_list\").html(),this.group.tiles=$(\"#rv_media_items_tiles\").html(),this.item={},this.item.list=$(\"#rv_media_items_list_element\").html(),this.item.tiles=$(\"#rv_media_items_tiles_element\").html(),this.$groupContainer=$(\".rv-media-items\")}return o(e,[{key:\"renderData\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this,n=i.a.getConfigs(),o=a.group[i.a.getRequestParams().view_type],s=i.a.getRequestParams().view_in;_.contains([\"my_media\",\"public\",\"trash\",\"favorites\",\"shared\",\"shared_with_me\",\"recent\"],s)||(s=\"my_media\"),o=o.replace(/__noItemIcon__/gi,RV_MEDIA_CONFIG.translations.no_item[s].icon||\"\").replace(/__noItemTitle__/gi,RV_MEDIA_CONFIG.translations.no_item[s].title||\"\").replace(/__noItemMessage__/gi,RV_MEDIA_CONFIG.translations.no_item[s].message||\"\");var c=$(o),l=c.find(\"ul\");_.size(e.folders)>0||_.size(e.files)>0?$(\".rv-media-items\").addClass(\"has-items\"):$(\".rv-media-items\").removeClass(\"has-items\"),_.forEach(e.folders,function(e,t){var r=a.item[i.a.getRequestParams().view_type];r=r.replace(/__type__/gi,\"folder\").replace(/__name__/gi,e.name||\"\").replace(/__size__/gi,\"\").replace(/__date__/gi,e.created_at||\"\").replace(/__thumb__/gi,'<i class=\"fa fa-folder-o\"></i>');var o=$(r);_.forEach(e,function(e,t){o.data(t,e)}),o.data(\"is_folder\",!0),o.data(\"icon\",n.icons.folder),l.append(o)}),_.forEach(e.files,function(e){var t=a.item[i.a.getRequestParams().view_type];if(t=t.replace(/__type__/gi,\"file\").replace(/__name__/gi,e.name||\"\").replace(/__size__/gi,e.size||\"\").replace(/__date__/gi,e.created_at||\"\"),\"list\"==i.a.getRequestParams().view_type)t=t.replace(/__thumb__/gi,'<i class=\"'+e.icon+'\"></i>');else switch(e.mime_type){case\"youtube\":t=t.replace(/__thumb__/gi,'<img src=\"'+e.options.thumb+'\" alt=\"'+e.name+'\">');break;default:t=t.replace(/__thumb__/gi,e.thumb?'<img src=\"'+e.thumb+'\" alt=\"'+e.name+'\">':'<i class=\"'+e.icon+'\"></i>')}var n=$(t);n.data(\"is_folder\",!1),_.forEach(e,function(e,t){n.data(t,e)}),l.append(n)}),0!=t&&a.$groupContainer.empty(),a.$groupContainer.append(c),a.$groupContainer.find(\".loading-wrapper\").remove(),r.a.handleDropdown()}},{key:\"getGroupContainer\",value:function(){return this.$groupContainer}}]),e}()},function(e,t,a){a(8),e.exports=a(16)},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(t,\"__esModule\",{value:!0});var i=a(1),r=a(0),o=a(3),s=a(2),c=a(11),l=a(12),d=a(4),u=a(13),f=a(5),m=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),p=function(){function e(){n(this,e),this.MediaService=new o.a,this.UploadService=new l.a,this.FolderService=new c.a,new u.a,this.$body=$(\"body\")}return m(e,[{key:\"init\",value:function(){this.setupLayout(),this.handleMediaList(),this.changeViewType(),this.changeFilter(),this.search(),this.handleActions(),this.UploadService.init(),this.handleModals()}},{key:\"setupLayout\",value:function(){var e=$('.js-rv-media-change-filter[data-type=\"filter\"][data-value=\"'+r.a.getRequestParams().filter+'\"]');e.closest(\"li\").addClass(\"active\").closest(\".dropdown\").find(\".js-rv-media-filter-current\").html(\"(\"+e.html()+\")\");var t=$('.js-rv-media-change-filter[data-type=\"view_in\"][data-value=\"'+r.a.getRequestParams().view_in+'\"]');t.closest(\"li\").addClass(\"active\").closest(\".dropdown\").find(\".js-rv-media-filter-current\").html(\"(\"+t.html()+\")\"),r.a.isUseInModal()&&$(\".rv-media-footer\").removeClass(\"hidden\"),$('.js-rv-media-change-filter[data-type=\"sort_by\"][data-value=\"'+r.a.getRequestParams().sort_by+'\"]').closest(\"li\").addClass(\"active\");var a=$(\"#media_details_collapse\");a.prop(\"checked\",i.a.hide_details_pane||!1),setTimeout(function(){$(\".rv-media-details\").removeClass(\"hidden\")},300),a.on(\"change\",function(e){e.preventDefault(),i.a.hide_details_pane=$(this).is(\":checked\"),r.a.storeConfig()})}},{key:\"handleMediaList\",value:function(){var e=this,t=!1,a=!1,n=!1;$(document).on(\"keyup keydown\",function(e){t=e.ctrlKey,a=e.metaKey,n=e.shiftKey}),e.$body.on(\"click\",\".js-media-list-title\",function(i){i.preventDefault();var o=$(this);if(n){var s=_.first(r.a.getSelectedItems());if(s){var c=s.index_key,l=o.index();$(\".rv-media-items li\").each(function(e){e>c&&e<=l&&$(this).find(\"input[type=checkbox]\").prop(\"checked\",!0)})}}else t||a||o.closest(\".rv-media-items\").find(\"input[type=checkbox]\").prop(\"checked\",!1);o.find(\"input[type=checkbox]\").prop(\"checked\",!0),d.a.handleDropdown(),e.MediaService.getFileDetails(o.data())}).on(\"dblclick\",\".js-media-list-title\",function(t){t.preventDefault();var a=$(this).data();if(!0===a.is_folder)e.FolderService.changeFolder(a.id);else if(r.a.isUseInModal()){var n=r.a.getSelectedFiles();_.size(n)>0&&f.EditorService.editorSelectFile(n)}else d.a.handlePreview()}).on(\"dblclick\",\".js-up-one-level\",function(e){e.preventDefault();var t=$(\".rv-media-breadcrumb .breadcrumb li\").length;$(\".rv-media-breadcrumb .breadcrumb li:nth-child(\"+(t-1)+\") a\").trigger(\"click\")}).on(\"contextmenu\",\".js-context-menu\",function(e){$(this).find(\"input[type=checkbox]\").is(\":checked\")||$(this).trigger(\"click\")}).on(\"click contextmenu\",\".rv-media-items\",function(t){_.size(t.target.closest(\".js-context-menu\"))||($('.rv-media-items input[type=\"checkbox\"]').prop(\"checked\",!1),$(\".rv-dropdown-actions\").addClass(\"disabled\"),e.MediaService.getFileDetails({icon:\"fa fa-picture-o\",nothing_selected:\"\"}))})}},{key:\"changeViewType\",value:function(){var e=this;e.$body.on(\"click\",\".js-rv-media-change-view-type .btn\",function(t){t.preventDefault();var a=$(this);a.hasClass(\"active\")||(a.closest(\".js-rv-media-change-view-type\").find(\".btn\").removeClass(\"active\"),a.addClass(\"active\"),i.a.request_params.view_type=a.data(\"type\"),r.a.storeConfig(),e.MediaService.getMedia(!0))}),$('.js-rv-media-change-view-type .btn[data-type=\"'+r.a.getRequestParams().view_type+'\"]').trigger(\"click\")}},{key:\"changeFilter\",value:function(){var e=this;e.$body.on(\"click\",\".js-rv-media-change-filter\",function(t){if(t.preventDefault(),!r.a.isOnAjaxLoading()){var a=$(this),n=a.closest(\"ul\"),s=a.data();i.a.request_params[s.type]=s.value,\"view_in\"==s.type&&(i.a.request_params.folder_id=0),a.closest(\".dropdown\").find(\".js-rv-media-filter-current\").html(\"(\"+a.html()+\")\"),r.a.storeConfig(),o.a.refreshFilter(),e.MediaService.getMedia(!0),n.find(\"> li\").removeClass(\"active\"),a.closest(\"li\").addClass(\"active\")}})}},{key:\"search\",value:function(){var e=this;$('.input-search-wrapper input[type=\"text\"]').val(r.a.getRequestParams().search||\"\"),e.$body.on(\"submit\",\".input-search-wrapper\",function(t){t.preventDefault(),i.a.request_params.search=$(this).find('input[type=\"text\"]').val(),r.a.storeConfig(),e.MediaService.getMedia(!0)})}},{key:\"handleActions\",value:function(){var e=this;e.$body.on(\"click\",'.rv-media-actions .js-change-action[data-type=\"refresh\"]',function(t){t.preventDefault(),e.MediaService.getMedia(!0)}).on(\"click\",\".rv-media-items li.no-items\",function(e){e.preventDefault(),$(\".rv-media-header .rv-media-top-header .rv-media-actions .js-dropzone-upload\").trigger(\"click\")}).on(\"submit\",\".form-add-folder\",function(t){t.preventDefault();var a=$(this).find(\"input[type=text]\"),n=a.val();e.FolderService.create(n),a.val(\"\")}).on(\"click\",\".js-change-folder\",function(t){t.preventDefault();var a=$(this).data(\"folder\");e.FolderService.changeFolder(a)}).on(\"click\",\".js-files-action\",function(t){t.preventDefault(),d.a.handleGlobalAction($(this).data(\"action\"),function(t){e.MediaService.getMedia(!0)})})}},{key:\"handleModals\",value:function(){var e=this;e.$body.on(\"show.bs.modal\",\"#modal_rename_items\",function(e){d.a.renderRenameItems()}),e.$body.on(\"submit\",\"#modal_rename_items .form-rename\",function(t){t.preventDefault();var a=[],n=$(this);$(\"#modal_rename_items .form-control\").each(function(){var e=$(this),t=e.closest(\".form-group\").data();t.name=e.val(),a.push(t)}),d.a.processAction({action:n.data(\"action\"),selected:a},function(t){t.error?$(\"#modal_rename_items .form-group\").each(function(){var e=$(this);_.contains(t.data,e.data(\"id\"))?e.addClass(\"has-error\"):e.removeClass(\"has-error\")}):(n.closest(\".modal\").modal(\"hide\"),e.MediaService.getMedia(!0))})}),e.$body.on(\"submit\",\".form-delete-items\",function(t){t.preventDefault();var a=[],n=$(this);_.each(r.a.getSelectedItems(),function(e){a.push({id:e.id,is_folder:e.is_folder})}),d.a.processAction({action:n.data(\"action\"),selected:a},function(t){n.closest(\".modal\").modal(\"hide\"),t.error||e.MediaService.getMedia(!0)})}),e.$body.on(\"submit\",\"#modal_empty_trash .rv-form\",function(t){t.preventDefault();var a=$(this);d.a.processAction({action:a.data(\"action\")},function(t){a.closest(\".modal\").modal(\"hide\"),e.MediaService.getMedia(!0)})});var t=[],a=$(\"#share_option\"),n=$(\"#share_to_users\");a.on(\"change\",function(e){e.preventDefault(),\"user\"===$(this).val()?n.closest(\".form-group\").removeClass(\"hidden\"):n.closest(\".form-group\").addClass(\"hidden\")}).trigger(\"change\"),e.$body.on(\"show.bs.modal\",\"#modal_share_items\",function(e){a.val(\"no_share\").trigger(\"change\"),n.val(\"\");var i=r.a.getSelectedItems();if(1!=_.size(i)){var o=!0;$.each(i,function(e,t){0==t.is_public&&(o=!1)}),o?a.val(\"everyone\").trigger(\"change\"):$.ajax({url:RV_MEDIA_URL.get_users,type:\"GET\",dataType:\"json\",success:function(e){e.error?s.a.showMessage(\"error\",e.message,RV_MEDIA_CONFIG.translations.message.error_header):(n.html(\"\"),t=e.data,_.each(t,function(e){var t='<option value=\"'+e.id+'\">'+e.name+\"</option>\";n.append(t)}))},error:function(e){s.a.handleError(e)}})}else{var c=_.first(i);c.is_public?a.val(\"everyone\").trigger(\"change\"):$.ajax({url:RV_MEDIA_URL.get_shared_users,type:\"GET\",data:{share_id:c.id,is_folder:c.is_folder},dataType:\"json\",success:function(e){if(e.error)s.a.showMessage(\"error\",e.message,RV_MEDIA_CONFIG.translations.message.error_header);else{n.html(\"\"),t=e.data.users;var i=0;_.each(t,function(e){var t=e.is_selected;t&&i++;var a='<option value=\"'+e.id+'\" '+(t?\"selected\":\"\")+\">\"+e.name+\"</option>\";n.append(a)}),i>0&&a.val(\"user\").trigger(\"change\")}},error:function(e){s.a.handleError(e)}})}}).on(\"submit\",\"#modal_share_items .rv-form\",function(t){t.preventDefault();var i=$(this),o=[];_.each(r.a.getSelectedItems(),function(e){o.push({id:e.id,is_folder:e.is_folder})}),d.a.processAction({action:i.data(\"action\"),selected:o,share_option:a.val(),users:n.val()},function(t){i.closest(\".modal\").modal(\"hide\"),e.MediaService.getMedia(!0)})}).on(\"submit\",\"#modal_set_focus_point .rv-form\",function(t){t.preventDefault();var a=$(this),n=[];_.each(r.a.getSelectedItems(),function(e){n.push({id:e.id,is_folder:e.is_folder})}),d.a.processAction({action:a.data(\"action\"),selected:n,data_attribute:$(\".helper-tool-data-attr\").val(),css_bg_position:$(\".helper-tool-css3-val\").val(),retice_css:$(\".helper-tool-reticle-css\").val()},function(t){e.MediaService.getMedia(!0),a.closest(\".modal\").modal(\"hide\")})})}}],[{key:\"setupSecurity\",value:function(){$.ajaxSetup({headers:{\"X-CSRF-TOKEN\":$('meta[name=\"csrf-token\"]').attr(\"content\")}})}}]),e}();$(document).ready(function(){window.rvMedia=window.rvMedia||{},p.setupSecurity(),(new p).init()})},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return s});var i=a(4),r=a(0),o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=function(){function e(){n(this,e)}return o(e,null,[{key:\"initContext\",value:function(){$.contextMenu({selector:'.js-context-menu[data-context=\"file\"]',build:function(t,a){return{items:e._fileContextMenu()}}}),$.contextMenu({selector:'.js-context-menu[data-context=\"folder\"]',build:function(t,a){return{items:e._folderContextMenu()}}})}},{key:\"_fileContextMenu\",value:function(){var e={preview:{name:\"Preview\",icon:function(e,t,a,n){return t.html('<i class=\"fa fa-eye\" aria-hidden=\"true\"></i> '+n.name),\"context-menu-icon-updated\"},callback:function(e,t){i.a.handlePreview()}},set_focus_point:{name:\"Set focus point\",icon:function(e,t,a,n){return t.html('<i class=\"fa fa-dot-circle-o\" aria-hidden=\"true\"></i> '+n.name),\"context-menu-icon-updated\"},callback:function(e,t){$('.js-files-action[data-action=\"set_focus_point\"]').trigger(\"click\")}}};_.each(r.a.getConfigs().actions_list,function(t,a){_.each(t,function(t){e[t.action]={name:t.name,icon:function(e,n,i,r){return n.html('<i class=\"'+t.icon+'\" aria-hidden=\"true\"></i> '+(RV_MEDIA_CONFIG.translations.actions_list[a][t.action]||r.name)),\"context-menu-icon-updated\"},callback:function(e,a){$('.js-files-action[data-action=\"'+t.action+'\"]').trigger(\"click\")}}})});var t=[];switch(r.a.getRequestParams().view_in){case\"my_media\":case\"public\":t=[\"remove_favorite\",\"delete\",\"restore\",\"remove_share\"];break;case\"shared\":t=[\"make_copy\",\"remove_favorite\",\"delete\",\"restore\",\"remove_share\"];break;case\"shared_with_me\":t=[\"share\",\"remove_favorite\",\"delete\",\"restore\",\"make_copy\"];break;case\"recent\":t=[\"remove_favorite\",\"delete\",\"restore\",\"remove_share\",\"make_copy\"];break;case\"favorites\":t=[\"favorite\",\"delete\",\"restore\",\"remove_share\",\"make_copy\"];break;case\"trash\":return{preview:e.preview,rename:e.rename,download:e.download,delete:e.delete,restore:e.restore}}_.each(t,function(t){e[t]=void 0}),r.a.getSelectedItems().length>1&&(e.set_focus_point=void 0),r.a.getSelectedFolder().length>0&&(e.preview=void 0,e.set_focus_point=void 0,e.copy_link=void 0,_.contains(RV_MEDIA_CONFIG.permissions,\"folders.create\")||(e.make_copy=void 0),_.contains(RV_MEDIA_CONFIG.permissions,\"folders.edit\")||(e.rename=void 0,e.share=void 0,e.remove_share=void 0,e.un_share=void 0),_.contains(RV_MEDIA_CONFIG.permissions,\"folders.delete\")||(e.trash=void 0,e.delete=void 0,e.restore=void 0));var a=r.a.getSelectedFiles();a.length>0&&\"image\"!==a[0].type&&(e.set_focus_point=void 0),a.length>0&&(_.contains(RV_MEDIA_CONFIG.permissions,\"files.create\")||(e.make_copy=void 0),_.contains(RV_MEDIA_CONFIG.permissions,\"files.edit\")||(e.rename=void 0,e.set_focus_point=void 0,e.share=void 0,e.remove_share=void 0,e.un_share=void 0),_.contains(RV_MEDIA_CONFIG.permissions,\"files.delete\")||(e.trash=void 0,e.delete=void 0,e.restore=void 0));var n=!1;return _.each(a,function(e){_.contains([\"image\",\"youtube\",\"pdf\",\"text\"],e.type)&&(n=!0)}),n||(e.preview=void 0),\"simple\"===RV_MEDIA_CONFIG.mode&&(e.share=void 0,e.un_share=void 0,e.remove_share=void 0),e}},{key:\"_folderContextMenu\",value:function(){var t=e._fileContextMenu();return t.preview=void 0,t.set_focus_point=void 0,t.copy_link=void 0,t}},{key:\"destroyContext\",value:function(){$.contextMenu(\"destroy\")}}]),e}()},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return o});var i=a(0),r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this.$detailsWrapper=$(\".rv-media-main .rv-media-details\"),this.descriptionItemTemplate='<div class=\"rv-media-name\"><p>__title__</p>__url__</div>',this.onlyFields=[\"name\",\"full_url\",\"size\",\"mime_type\",\"created_at\",\"updated_at\",\"nothing_selected\"],this.externalTypes=[\"youtube\",\"vimeo\",\"metacafe\",\"dailymotion\",\"vine\",\"instagram\"]}return r(e,[{key:\"renderData\",value:function(e){var t=this,a=\"image\"===e.type?'<img src=\"'+e.full_url+'\" alt=\"'+e.name+'\">':\"youtube\"===e.mime_type?'<img src=\"'+e.options.thumb+'\" alt=\"'+e.name+'\">':'<i class=\"'+e.icon+'\"></i>',n=\"\",r=!1;if(_.forEach(e,function(a,o){_.contains(t.onlyFields,o)&&(!_.contains(t.externalTypes,e.type)||_.contains(t.externalTypes,e.type)&&!_.contains([\"size\",\"mime_type\"],o))&&(n+=t.descriptionItemTemplate.replace(/__title__/gi,RV_MEDIA_CONFIG.translations[o]).replace(/__url__/gi,a?\"full_url\"===o?'<div class=\"input-group\"><input id=\"file_details_url\" type=\"text\" value=\"'+a+'\" class=\"form-control\"><span class=\"input-group-btn\"><button class=\"btn btn-default js-btn-copy-to-clipboard\" type=\"button\" data-clipboard-target=\"#file_details_url\" title=\"Copied\" data-trigger=\"click\"><img class=\"clippy\" src=\"'+i.a.asset(\"/vendor/media/images/clippy.svg\")+'\" width=\"13\" alt=\"Copy to clipboard\"></button></span></div>':'<span title=\"'+a+'\">'+a+\"</span>\":\"\"),\"full_url\"===o&&(r=!0))}),t.$detailsWrapper.find(\".rv-media-thumbnail\").html(a),t.$detailsWrapper.find(\".rv-media-description\").html(n),r){new Clipboard(\".js-btn-copy-to-clipboard\");$(\".js-btn-copy-to-clipboard\").tooltip().on(\"mouseleave\",function(e){$(this).tooltip(\"hide\")})}}}]),e}()},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return d});var i=a(6),r=a(1),o=a(3),s=a(2),c=a(0),l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=function(){function e(){n(this,e),this.MediaList=new i.a,this.MediaService=new o.a,$(\"body\").on(\"shown.bs.modal\",\"#modal_add_folder\",function(){$(this).find(\".form-add-folder input[type=text]\").focus()})}return l(e,[{key:\"create\",value:function(t){var a=this;$.ajax({url:RV_MEDIA_URL.create_folder,type:\"POST\",data:{parent_id:c.a.getRequestParams().folder_id,name:t},dataType:\"json\",beforeSend:function(){c.a.showAjaxLoading()},success:function(t){t.error?s.a.showMessage(\"error\",t.message,RV_MEDIA_CONFIG.translations.message.error_header):(s.a.showMessage(\"success\",t.message,RV_MEDIA_CONFIG.translations.message.success_header),a.MediaService.getMedia(!0),e.closeModal())},complete:function(e){c.a.hideAjaxLoading()},error:function(e){s.a.handleError(e)}})}},{key:\"changeFolder\",value:function(e){r.a.request_params.folder_id=e,c.a.storeConfig(),this.MediaService.getMedia(!0)}}],[{key:\"closeModal\",value:function(){$(\"#modal_add_folder\").modal(\"hide\")}}]),e}()},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return s});var i=a(3),r=a(0),o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=function(){function e(){n(this,e),this.$body=$(\"body\"),this.dropZone=null,this.uploadUrl=RV_MEDIA_URL.upload_file,this.uploadProgressBox=$(\".rv-upload-progress\"),this.uploadProgressContainer=$(\".rv-upload-progress .rv-upload-progress-table\"),this.uploadProgressTemplate=$(\"#rv_media_upload_progress_item\").html(),this.totalQueued=1,this.MediaService=new i.a,this.totalError=0}return o(e,[{key:\"init\",value:function(){this.setupDropZone(),this.handleEvents()}},{key:\"setupDropZone\",value:function(){var e=this;e.dropZone=new Dropzone(document.querySelector(\".rv-media-items\"),{url:e.uploadUrl,thumbnailWidth:!1,thumbnailHeight:!1,parallelUploads:1,autoQueue:!0,clickable:\".js-dropzone-upload\",previewTemplate:!1,previewsContainer:!1,uploadMultiple:!0,sending:function(e,t,a){a.append(\"_token\",$('meta[name=\"csrf-token\"]').attr(\"content\")),a.append(\"folder_id\",r.a.getRequestParams().folder_id),a.append(\"view_in\",r.a.getRequestParams().view_in)}}),e.dropZone.on(\"addedfile\",function(t){t.index=e.totalQueued,e.totalQueued++}),e.dropZone.on(\"sending\",function(t){e.initProgress(t.name,t.size)}),e.dropZone.on(\"success\",function(e){}),e.dropZone.on(\"complete\",function(t){e.changeProgressStatus(t)}),e.dropZone.on(\"queuecomplete\",function(){e.MediaService.getMedia(!0),0===e.totalError&&setTimeout(function(){$(\".rv-upload-progress .close-pane\").trigger(\"click\")},5e3)})}},{key:\"handleEvents\",value:function(){var e=this;e.$body.on(\"click\",\".rv-upload-progress .close-pane\",function(t){t.preventDefault(),$(\".rv-upload-progress\").addClass(\"hide-the-pane\"),e.totalError=0,setTimeout(function(){$(\".rv-upload-progress li\").remove(),e.totalQueued=1},300)})}},{key:\"initProgress\",value:function(t,a){var n=this.uploadProgressTemplate.replace(/__fileName__/gi,t).replace(/__fileSize__/gi,e.formatFileSize(a)).replace(/__status__/gi,\"warning\").replace(/__message__/gi,\"Uploading\");this.uploadProgressContainer.append(n),this.uploadProgressBox.removeClass(\"hide-the-pane\"),this.uploadProgressBox.find(\".panel-body\").animate({scrollTop:this.uploadProgressContainer.height()},150)}},{key:\"changeProgressStatus\",value:function(e){var t=this,a=t.uploadProgressContainer.find(\"li:nth-child(\"+e.index+\")\"),n=a.find(\".label\");n.removeClass(\"label-success label-danger label-warning\");var i=r.a.jsonDecode(e.xhr.responseText||\"\",{});if(t.totalError=t.totalError+(!0===i.error||\"error\"===e.status?1:0),n.addClass(!0===i.error||\"error\"===e.status?\"label-danger\":\"label-success\"),n.html(!0===i.error||\"error\"===e.status?\"Error\":\"Uploaded\"),\"error\"===e.status)if(422===e.xhr.status){var o=\"\";$.each(i,function(e,t){o+='<span class=\"text-danger\">'+t+\"</span><br>\"}),a.find(\".file-error\").html(o)}else 500===e.xhr.status&&a.find(\".file-error\").html('<span class=\"text-danger\">'+e.xhr.statusText+\"</span>\");else i.error?a.find(\".file-error\").html('<span class=\"text-danger\">'+i.message+\"</span>\"):r.a.addToRecent(i.data.id)}}],[{key:\"formatFileSize\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t?1e3:1024;if(Math.abs(e)<a)return e+\" B\";var n=[\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"],i=-1;do{e/=a,++i}while(Math.abs(e)>=a&&i<n.length-1);return e.toFixed(1)+\" \"+n[i]}}]),e}()},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return r});var i=a(14),r=function e(){n(this,e),new i.a}},function(e,t,a){\"use strict\";function n(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}a.d(t,\"a\",function(){return l});var i=a(0),r=a(15),o=(a(1),a(3)),s=a(2),c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=function(){function e(){n(this,e),this.MediaService=new o.a,this.$body=$(\"body\"),this.$modal=$(\"#modal_add_from_youtube\");var t=this;this.setMessage(RV_MEDIA_CONFIG.translations.add_from.youtube.original_msg),this.$modal.on(\"hidden.bs.modal\",function(){t.setMessage(RV_MEDIA_CONFIG.translations.add_from.youtube.original_msg)}),this.$body.on(\"click\",\"#modal_add_from_youtube .rv-btn-add-youtube-url\",function(e){e.preventDefault(),t.checkYouTubeVideo($(this).closest(\"#modal_add_from_youtube\").find(\".rv-youtube-url\"))})}return c(e,[{key:\"setMessage\",value:function(e){this.$modal.find(\".modal-notice\").html(e)}},{key:\"checkYouTubeVideo\",value:function(t){function a(e,t){$.ajax({url:RV_MEDIA_URL.add_external_service,type:\"POST\",dataType:\"json\",data:{type:\"youtube\",name:e.items[0].snippet.title,folder_id:i.a.getRequestParams().folder_id,url:t,options:{thumb:\"https://img.youtube.com/vi/\"+e.items[0].id+\"/maxresdefault.jpg\"}},success:function(e){e.error?s.a.showMessage(\"error\",e.message,RV_MEDIA_CONFIG.translations.message.error_header):(s.a.showMessage(\"success\",e.message,RV_MEDIA_CONFIG.translations.message.success_header),o.MediaService.getMedia(!0))},error:function(e){s.a.handleError(e)}}),o.$modal.modal(\"hide\")}function n(e,t){o.$modal.modal(\"hide\")}var o=this;if(e.validateYouTubeLink(t.val())&&r.a.youtube.api_key){var c=e.getYouTubeId(t.val()),l=\"https://www.googleapis.com/youtube/v3/videos?id=\"+c,d=o.$modal.find('.custom-checkbox input[type=\"checkbox\"]').is(\":checked\");d&&(c=e.getYoutubePlaylistId(t.val()),l=\"https://www.googleapis.com/youtube/v3/playlistItems?playlistId=\"+c),$.ajax({url:l+\"&key=\"+r.a.youtube.api_key+\"&part=snippet\",type:\"GET\",success:function(e){d?n(e,t.val()):a(e,t.val())},error:function(e){o.setMessage(RV_MEDIA_CONFIG.translations.add_from.youtube.error_msg)}})}else r.a.youtube.api_key?o.setMessage(RV_MEDIA_CONFIG.translations.add_from.youtube.invalid_url_msg):o.setMessage(RV_MEDIA_CONFIG.translations.add_from.youtube.no_api_key_msg)}}],[{key:\"validateYouTubeLink\",value:function(e){var t=/^(?:https?:\\/\\/)?(?:www\\.)?youtube\\.com\\/watch\\?(?=.*v=((\\w|-){11}))(?:\\S+)?$/;return!!e.match(t)&&RegExp.$1}},{key:\"getYouTubeId\",value:function(e){var t=/^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=)([^#\\&\\?]*).*/,a=e.match(t);return a&&11==a[2].length?a[2]:null}},{key:\"getYoutubePlaylistId\",value:function(e){var t=/^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?list=|\\&list=)([^#\\&\\?]*).*/,a=e.match(t);return a?a[2]:null}}]),e}()},function(e,t,a){\"use strict\";a.d(t,\"a\",function(){return n});var n={youtube:{api_key:\"AIzaSyCV4fmfdgsValGNR3sc-0W3cbpEZ8uOd60\"}}},function(e,t){}]);\n\n\n// WEBPACK FOOTER //\n// /js/media.js"],"mappings":"AAAA","sourceRoot":""}